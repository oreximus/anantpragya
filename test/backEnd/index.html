<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>API Documentation</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
        margin: 0;
        padding: 20px;
        background-color: #f4f4f4;
        color: #333;
      }
      .container {
        max-width: 900px;
        margin: 20px auto;
        background: #fff;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      h1,
      h2,
      h3 {
        color: #0056b3;
      }
      pre {
        background: #eee;
        padding: 15px;
        border-radius: 5px;
        overflow-x: auto;
      }
      code {
        font-family: "Courier New", Courier, monospace;
        background: #e9e9e9;
        padding: 2px 4px;
        border-radius: 3px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
      }
      table,
      th,
      td {
        border: 1px solid #ddd;
      }
      th,
      td {
        padding: 10px;
        text-align: left;
      }
      th {
        background-color: #f2f2f2;
      }
      .note {
        background-color: #e7f3fe;
        border-left: 6px solid #2196f3;
        margin-bottom: 10px;
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>API Documentation</h1>

      <p>Welcome to the API documentation for your Node.js application.</p>

      <div class="note">
        <strong>Base URL:</strong> <code>http://localhost:4000/api</code> (or
        your deployed URL)
      </div>

      <h2>Authentication</h2>

      <h3><code>POST /api/auth/register</code></h3>
      <p>Registers a new user.</p>
      <h4>Request Body:</h4>
      <pre><code>{
  "first_name": "John",
  "last_name": "Doe",
  "email": "john.doe@example.com",
  "password": "password123",
  "confirm_password": "password123"
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Registration successful, please check your email",
  "data": {}
}</code></pre>

      <h3><code>POST /api/auth/verify-email</code></h3>
      <p>Verifies a user's email address using a token.</p>
      <h4>Request Body:</h4>
      <pre><code>{
  "token": "your-verification-token"
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Email verification successful, you can now login",
  "data": {}
}</code></pre>

      <h3><code>POST /api/auth/authenticate</code></h3>
      <p>Authenticates a user and returns JWT and refresh tokens.</p>
      <h4>Request Body:</h4>
      <pre><code>{
  "email": "john.doe@example.com",
  "password": "password123"
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Login successful",
  "data": {
    "id": "uuid-of-user",
    "first_name": "John",
    "last_name": "Doe",
    "email": "john.doe@example.com",
    "role": "User",
    "jwtToken": "your-jwt-token",
    "refreshToken": "your-refresh-token"
  }
}</code></pre>

      <h3><code>POST /api/auth/refresh-token</code></h3>
      <p>Refreshes the JWT token using a refresh token (sent as cookie).</p>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Token refreshed successfully",
  "data": {
    "id": "uuid-of-user",
    "first_name": "John",
    "last_name": "Doe",
    "email": "john.doe@example.com",
    "role": "User",
    "jwtToken": "new-jwt-token",
    "refreshToken": "new-refresh-token"
  }
}</code></pre>

      <h3><code>POST /api/auth/revoke-token</code></h3>
      <p>Revokes a refresh token. Requires authentication.</p>
      <h4>Request Body (optional, if not in cookie):</h4>
      <pre><code>{
  "token": "refresh-token-to-revoke"
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Token revoked",
  "data": {}
}</code></pre>

      <h3><code>POST /api/auth/forgot-password</code></h3>
      <p>Sends a password reset link to the user's email.</p>
      <h4>Request Body:</h4>
      <pre><code>{
  "email": "john.doe@example.com"
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Please check your email for password reset instructions",
  "data": {}
}</code></pre>

      <h3><code>POST /api/auth/validate-reset-token</code></h3>
      <p>Validates a password reset token.</p>
      <h4>Request Body:</h4>
      <pre><code>{
  "token": "your-reset-token"
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Token is valid",
  "data": {}
}</code></pre>

      <h3><code>POST /api/auth/reset-password</code></h3>
      <p>Resets the user's password using a valid reset token.</p>
      <h4>Request Body:</h4>
      <pre><code>{
  "token": "your-reset-token",
  "password": "new-password123",
  "confirm_password": "new-password123"
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Password reset successful, you can now login",
  "data": {}
}</code></pre>

      <h3><code>POST /api/auth/change-password</code></h3>
      <p>Allows an authenticated user to change their password.</p>
      <h4>Request Body:</h4>
      <pre><code>{
  "current_password": "old-password123",
  "new_password": "new-password123",
  "confirm_new_password": "new-password123"
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Password changed successfully",
  "data": {}
}</code></pre>

      <h2>User Management (Admin Only)</h2>

      <h3><code>GET /api/user/list</code></h3>
      <p>Get a list of all users. Requires Admin role.</p>
      <h4>Query Parameters:</h4>
      <ul>
        <li><code>page</code> (optional): Page number (default: 1)</li>
        <li><code>limit</code> (optional): Items per page (default: 10)</li>
        <li><code>search</code> (optional): Search term for first name, last name, or email</li>
      </ul>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "User list fetched successfully",
  "data": {
    "count": 1,
    "rows": [
      {
        "id": "uuid-of-user",
        "first_name": "Admin",
        "last_name": "User",
        "email": "admin@example.com",
        "role": "Admin",
        "is_active": 1,
        "created_at": "2023-10-27 10:00:00",
        "updated_at": "2023-10-27 10:00:00"
      }
    ]
  }
}</code></pre>

      <h3><code>GET /api/user/:id</code></h3>
      <p>Get user details by ID. Requires Admin role.</p>
      <h4>Path Parameters:</h4>
      <ul>
        <li><code>id</code>: UUID of the user</li>
      </ul>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "User fetched successfully",
  "data": {
    "id": "uuid-of-user",
    "first_name": "Admin",
    "last_name": "User",
    "email": "admin@example.com",
    "role": "Admin",
    "is_active": 1,
    "created_at": "2023-10-27 10:00:00",
    "updated_at": "2023-10-27 10:00:00"
  }
}</code></pre>

      <h3><code>POST /api/user/create</code></h3>
      <p>Create a new user. Requires Admin role.</p>
      <h4>Request Body:</h4>
      <pre><code>{
  "first_name": "New",
  "last_name": "User",
  "email": "new.user@example.com",
  "password": "password123",
  "role": "User"
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "User created successfully",
  "data": {}
}</code></pre>

      <h3><code>PUT /api/user/update</code></h3>
      <p>Update user details. Requires Admin role.</p>
      <h4>Request Body:</h4>
      <pre><code>{
  "id": "uuid-of-user",
  "first_name": "Updated",
  "last_name": "Name",
  "email": "updated.email@example.com",
  "role": "Editor"
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "User updated successfully",
  "data": {}
}</code></pre>

      <h3><code>DELETE /api/user/delete</code></h3>
      <p>Delete a user (soft delete). Requires Admin role.</p>
      <h4>Request Body:</h4>
      <pre><code>{
  "id": "uuid-of-user-to-delete"
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "User deleted successfully",
  "data": {}
}</code></pre>

      <h3><code>PUT /api/user/status</code></h3>
      <p>Update user active status. Requires Admin role.</p>
      <h4>Request Body:</h4>
      <pre><code>{
  "id": "uuid-of-user",
  "is_active": 0 // 0 for inactive, 1 for active
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "User status updated successfully",
  "data": {}
}</code></pre>

      <h2>Post Management</h2>

      <h3><code>GET /api/post/categories</code></h3>
      <p>Get a list of all post categories.</p>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Post categories fetched successfully",
  "data": [
    {
      "id": "uuid-of-category",
      "name": "Technology",
      "is_active": 1,
      "created_at": "2023-10-27 10:00:00",
      "updated_at": "2023-10-27 10:00:00"
    }
  ]
}</code></pre>

      <h3><code>GET /api/post/list</code></h3>
      <p>Get a list of all posts.</p>
      <h4>Query Parameters:</h4>
      <ul>
        <li><code>page</code> (optional): Page number (default: 1)</li>
        <li><code>limit</code> (optional): Items per page (default: 10)</li>
        <li><code>search</code> (optional): Search term for title, content, summary, or tags</li>
        <li><code>category_id</code> (optional): Filter by category UUID</li>
      </ul>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Post list fetched successfully",
  "data": {
    "count": 1,
    "rows": [
      {
        "id": "uuid-of-post",
        "category_id": "uuid-of-category",
        "title": "My First Post",
        "summary": "A brief summary of the post.",
        "post_data": "Full content of the post.",
        "status": "published",
        "tags": ["tag1", "tag2"],
        "created_at": "2023-10-27 10:00:00",
        "updated_at": "2023-10-27 10:00:00",
        "PostCategory": {
          "id": "uuid-of-category",
          "name": "Technology"
        },
        "author": {
          "id": "uuid-of-author",
          "first_name": "John",
          "last_name": "Doe",
          "email": "john.doe@example.com"
        },
        "activities": [
          {
            "id": "uuid-of-activity",
            "is_liked": 1,
            "created_by": "uuid-of-user",
            "user": {
              "id": "uuid-of-user",
              "first_name": "Jane",
              "last_name": "Smith"
            }
          }
        ],
        "files": [
          {
            "id": "uuid-of-file",
            "original_name": "image.jpg",
            "file_path": "https://your-s3-bucket.s3.amazonaws.com/posts/image.jpg"
          }
        ]
      }
    ]
  }
}</code></pre>

      <h3><code>GET /api/post/:id</code></h3>
      <p>Get post details by ID.</p>
      <h4>Path Parameters:</h4>
      <ul>
        <li><code>id</code>: UUID of the post</li>
      </ul>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Post fetched successfully",
  "data": {
    "id": "uuid-of-post",
    "category_id": "uuid-of-category",
    "title": "My First Post",
    "summary": "A brief summary of the post.",
    "post_data": "Full content of the post.",
    "status": "published",
    "tags": ["tag1", "tag2"],
    "created_at": "2023-10-27 10:00:00",
    "updated_at": "2023-10-27 10:00:00",
    "PostCategory": {
      "id": "uuid-of-category",
      "name": "Technology"
    },
    "author": {
      "id": "uuid-of-author",
      "first_name": "John",
      "last_name": "Doe",
      "email": "john.doe@example.com"
    },
    "activities": [],
    "files": []
  }
}</code></pre>

      <h3><code>POST /api/post/create</code></h3>
      <p>Create a new post. Requires Admin or Editor role.</p>
      <h4>Request Body (multipart/form-data):</h4>
      <ul>
        <li><code>category</code>: Category name (e.g., "Technology")</li>
        <li><code>title</code>: Post title</li>
        <li><code>summary</code> (optional): Post summary</li>
        <li><code>content</code> (optional): Full post content</li>
        <li><code>tags</code> (optional): JSON stringified array of tags (e.g., <code>["tag1", "tag2"]</code>)</li>
        <li><code>status</code> (optional): "draft" or "published" (default: "draft")</li>
        <li><code>featured_image</code> (optional): File upload for the featured image</li>
      </ul>
      <h4>Example (using curl):</h4>
      <pre><code>curl -X POST \
  http://localhost:4000/api/post/create \
  -H 'Authorization: Bearer YOUR_JWT_TOKEN' \
  -H 'Content-Type: multipart/form-data' \
  -F 'category=Technology' \
  -F 'title=My New Post' \
  -F 'summary=This is a new post summary.' \
  -F 'content=This is the full content of my new post.' \
  -F 'tags=["nodejs", "api"]' \
  -F 'status=published' \
  -F 'featured_image=@/path/to/your/image.jpg'</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Post created successfully",
  "data": {
    "id": "uuid-of-new-post"
  }
}</code></pre>

      <h3><code>PUT /api/post/update</code></h3>
      <p>Update an existing post. Requires Admin or Editor role.</p>
      <h4>Request Body (multipart/form-data):</h4>
      <ul>
        <li><code>id</code>: UUID of the post to update</li>
        <li><code>category</code> (optional): New category name</li>
        <li><code>title</code> (optional): New post title</li>
        <li><code>summary</code> (optional): New post summary</li>
        <li><code>content</code> (optional): New full post content</li>
        <li><code>tags</code> (optional): JSON stringified array of new tags</li>
        <li><code>status</code> (optional): "draft" or "published"</li>
        <li><code>featured_image</code> (optional): New file upload for the featured image (will replace existing)</li>
      </ul>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Post updated successfully",
  "data": {}
}</code></pre>

      <h3><code>DELETE /api/post/delete</code></h3>
      <p>Delete a post (soft delete). Requires Admin or Editor role.</p>
      <h4>Request Body:</h4>
      <pre><code>{
  "id": "uuid-of-post-to-delete"
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Post deleted successfully",
  "data": {}
}</code></pre>

      <h3><code>POST /api/post/like</code></h3>
      <p>Like or unlike a post. Requires User, Editor, or Admin role.</p>
      <h4>Request Body:</h4>
      <pre><code>{
  "post_id": "uuid-of-post"
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Post liked/unliked successfully",
  "data": {}
}</code></pre>

      <h3><code>POST /api/post/comment</code></h3>
      <p>Add a comment to a post. Requires User, Editor, or Admin role.</p>
      <h4>Request Body:</h4>
      <pre><code>{
  "post_id": "uuid-of-post",
  "comment": "This is a great post!"
}</code></pre>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Comment added successfully",
  "data": {
    "id": "uuid-of-new-comment"
  }
}</code></pre>

      <h3><code>GET /api/post/comments/:id</code></h3>
      <p>Get comments for a specific post.</p>
      <h4>Path Parameters:</h4>
      <ul>
        <li><code>id</code>: UUID of the post</li>
      </ul>
      <h4>Query Parameters:</h4>
      <ul>
        <li><code>page</code> (optional): Page number (default: 1)</li>
        <li><code>limit</code> (optional): Items per page (default: 10)</li>
      </ul>
      <h4>Response:</h4>
      <pre><code>{
  "status": true,
  "message": "Post comments fetched successfully",
  "data": {
    "count": 1,
    "rows": [
      {
        "id": "uuid-of-comment",
        "post_id": "uuid-of-post",
        "comment": "This is a great post!",
        "created_at": "2023-10-27 10:00:00",
        "updated_at": "2023-10-27 10:00:00",
        "author": {
          "id": "uuid-of-author",
          "first_name": "Jane",
          "last_name": "Smith",
          "email": "jane.smith@example.com"
        },
        "files": []
      }
    ]
  }
}</code></pre>
    </div>
  </body>
</html>
